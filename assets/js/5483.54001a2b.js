"use strict";(self.webpackChunk_motion_canvas_docs=self.webpackChunk_motion_canvas_docs||[]).push([[5483],{5483:(t,e,s)=>{s.r(e);var i=Object.defineProperty,a=(t,e,s)=>(((t,e,s)=>{e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s})(t,"symbol"!=typeof e?e+"":e,s),s);const o="motion-canvas-player";class r extends HTMLElement{constructor(){super(),a(this,"root"),a(this,"canvas"),a(this,"overlay"),a(this,"button"),a(this,"state","initial"),a(this,"defaultWidth",1920),a(this,"defaultHeight",1080),a(this,"project",null),a(this,"abortController",null),a(this,"runId",null),a(this,"mouseMoveId",null),a(this,"renderTime",0),a(this,"finished",!1),a(this,"playing",!1),a(this,"connected",!1),a(this,"handleMouseMove",(()=>{this.mouseMoveId&&clearTimeout(this.mouseMoveId),this.hover&&!this.playing&&this.setPlaying(!0),this.mouseMoveId=window.setTimeout((()=>{this.mouseMoveId=null,this.updateClass()}),2e3),this.updateClass()})),a(this,"handleMouseLeave",(()=>{this.hover&&this.setPlaying(!1),this.mouseMoveId&&(clearTimeout(this.mouseMoveId),this.mouseMoveId=null,this.updateClass())})),a(this,"handleMouseDown",(t=>{t.preventDefault()})),a(this,"handleClick",(()=>{this.auto||(this.handleMouseMove(),this.setPlaying(!this.playing),this.button.animate([{scale:"0.9"},{scale:"1",easing:"ease-out"}],{duration:200}))})),this.root=this.attachShadow({mode:"open"}),this.root.innerHTML='<style>.initial{display:none}.state-initial .initial{display:block}.loading{display:none}.state-loading .loading{display:block}.ready{display:none}.state-ready .ready{display:block}.error{display:none}.state-error .error{display:block}:host{position:relative;display:block}.overlay{position:absolute;left:0;right:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;opacity:0;background-color:#0000008a;transition:opacity .1s}.overlay.state-ready:not(.auto){cursor:pointer}.overlay.playing:not(.hover):hover{cursor:none}.overlay.hover,.overlay.state-ready:focus-within,.overlay.state-ready:not(.playing){opacity:1}.overlay.hover .button,.overlay.state-ready:focus-within .button,.overlay.state-ready:not(.playing) .button{scale:1;transition:scale .1s ease-out}.overlay.state-loading,.overlay.state-error{opacity:1;transition:opacity 1s}.overlay.state-ready.auto{opacity:0}.button{width:50%;max-width:96px;aspect-ratio:1;scale:.5;transition:scale .1s ease-in,opacity .1s;background-color:transparent;border:none;background-size:100% 100%;background-repeat:no-repeat;opacity:.54;cursor:inherit;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iI2ZmZmZmZiI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bS0yIDE0LjV2LTlsNiA0LjUtNiA0LjV6Ii8+PC9zdmc+)}.playing .button{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIGZpbGw9IiNmZmZmZmYiPjxnPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjwvZz48Zz48Zy8+PHBhdGggZD0iTTEyLDJDNi40OCwyLDIsNi40OCwyLDEyczQuNDgsMTAsMTAsMTBzMTAtNC40OCwxMC0xMFMxNy41MiwyLDEyLDJ6IE0xMSwxNkg5VjhoMlYxNnogTTE1LDE2aC0yVjhoMlYxNnoiLz48L2c+PC9zdmc+)}.button:focus,.overlay:hover .button{opacity:.87}.auto .button{display:none}.canvas{width:100%;display:block;opacity:0;transition:opacity .1s}.canvas.state-ready{opacity:1}.message{font-family:JetBrains Mono,sans-serif;text-align:center;font-size:20px;padding:8px 16px;margin:16px;border-radius:4px;color:#fff9;background-color:#000000de}.loader{width:50%;max-width:96px;display:none;rotate:-90deg;animation:stroke 2s cubic-bezier(.5,0,.5,1) infinite,rotate 2s linear infinite}@keyframes stroke{0%{stroke-dasharray:5.6548667765px 50.8938009883px;stroke-dashoffset:2.8274333882px}50%{stroke-dasharray:50.8938009883px 5.6548667765px;stroke-dashoffset:-2.8274333882px}to{stroke-dasharray:5.6548667765px 50.8938009883px;stroke-dashoffset:-53.7212343766px}}@keyframes rotate{0%{rotate:-110deg}to{rotate:250deg}}\n</style><canvas class="canvas"></canvas>\n<div class="overlay">\n  <button title="Play / Pause" class="button ready" tabindex="0"></button>\n  <div class="message error">\n    An error occurred while loading the animation.\n  </div>\n  <svg\n    class="loader loading"\n    viewBox="0 0 24 24"\n    stroke="#ffffff"\n    stroke-width="2"\n    fill="transparent"\n  >\n    <circle cx="12" cy="12" r="9" />\n  </svg>\n</div>\n',this.canvas=this.root.querySelector(".canvas"),this.overlay=this.root.querySelector(".overlay"),this.button=this.root.querySelector(".button"),this.overlay.addEventListener("click",this.handleClick),this.overlay.addEventListener("mousemove",this.handleMouseMove),this.overlay.addEventListener("mouseleave",this.handleMouseLeave),this.button.addEventListener("mousedown",this.handleMouseDown),this.setState("initial")}static get observedAttributes(){return["src","quality","width","height","auto","variables"]}get auto(){return!!this.getAttribute("auto")}get hover(){return"hover"===this.getAttribute("auto")}get quality(){const t=this.getAttribute("quality");return t?parseFloat(t):1}get width(){const t=this.getAttribute("width");return t?parseFloat(t):this.defaultWidth}get height(){const t=this.getAttribute("height");return t?parseFloat(t):this.defaultHeight}get variables(){try{const t=this.getAttribute("variables");return t?JSON.parse(t):{}}catch{return this.project.logger.warn("Project variables could not be parsed."),{}}}setState(t){this.state=t,this.setPlaying(this.playing)}setPlaying(t){"ready"===this.state&&(t||this.auto&&!this.hover)?(this.playing=!0,this.request()):this.playing=!1,this.updateClass()}updateClass(){this.overlay.className=`overlay state-${this.state}`,this.canvas.className=`canvas state-${this.state}`,this.overlay.classList.toggle("playing",this.playing),this.overlay.classList.toggle("auto",this.auto),this.overlay.classList.toggle("hover",null!==this.mouseMoveId),this.connected&&(null===this.mouseMoveId&&this.playing?delete this.dataset.overlay:this.dataset.overlay="")}shouldPlay(){return"ready"===this.state&&this.playing&&this.connected}async updateSource(t){var e;let s;this.setState("initial"),null==(e=this.abortController)||e.abort(),this.abortController=new AbortController;try{const e=import(t),i=new Promise((t=>setTimeout(t,200)));await Promise.any([i,e]),this.setState("loading"),s=(await e).default(),s.setVariables(this.variables)}catch{return void this.setState("error")}if(this.abortController.signal.aborted||(s.framerate=60,await s.recalculate(),this.abortController.signal.aborted)||(await s.seek(0),this.abortController.signal.aborted))return;const i=s.getSize();this.defaultWidth=i.width,this.defaultHeight=i.height,this.finished=!1,this.project=s,this.project.resolutionScale=this.quality,this.project.setSize([this.width,this.height]),this.project.logger.onLogged.subscribe(console.log),this.project.setCanvas(this.canvas),this.setState("ready")}async run(){this.finished&&await this.project.seek(0),this.shouldPlay()&&(this.finished=await this.project.next(),this.shouldPlay()&&await this.project.render())}request(){null!=this.runId||(this.runId=requestAnimationFrame((async t=>{if(this.runId=null,this.shouldPlay()){if(t-this.renderTime>=1e3/(this.project.framerate+5)){this.renderTime=t;try{await this.run()}catch{return void this.setState("error")}}this.request()}})))}attributeChangedCallback(t,e,s){switch(t){case"auto":this.setPlaying(this.playing);break;case"src":this.updateSource(s);break;case"quality":this.project&&(this.project.resolutionScale=this.quality);break;case"width":case"height":this.project&&this.project.setSize([this.width,this.height]);break;case"variables":this.project&&this.project.setVariables(this.variables)}}disconnectedCallback(){this.connected=!1}connectedCallback(){this.connected=!0,this.request()}}customElements.get(o)||customElements.define(o,r)}}]);